<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">
<meta name="referrer" content="never">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="../../lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="../../lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="../../css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="../../images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="../../atom.xml" title="乱码三千 – 分享实用IT技术" type="application/atom+xml">






<meta name="description" content="android程序员一枚,擅长java,kotlin,python,金融投资,欢迎交流~">
<meta name="keywords" content="android,java,kotlin,golang,go,python,自动化,量化,金融,php,docker,linux">
<meta property="og:type" content="website">
<meta property="og:title" content="乱码三千 – 分享实用IT技术">
<meta property="og:url" content="https://code.newban.cn/page/37/index.html">
<meta property="og:site_name" content="乱码三千 – 分享实用IT技术">
<meta property="og:description" content="android程序员一枚,擅长java,kotlin,python,金融投资,欢迎交流~">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="乱码三千 – 分享实用IT技术">
<meta name="twitter:description" content="android程序员一枚,擅长java,kotlin,python,金融投资,欢迎交流~">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<!--谷歌广告验证代码-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-2626449904708114",
          enable_page_level_ads: true
     });
</script>
<!--谷歌广告验证代码-->

<!--短链广告-->
<!--<script type="text/javascript">
    var adfly_id = 25792435;
    var adfly_advert = 'banner';
    var popunder = false;
    var exclude_domains = ['code.newban.cn','newban.cn',  'localhost:4000'];
</script>
<script src="https://cdn.adf.ly/js/link-converter.js"></script>-->
<!--短链广告-->



  <link rel="canonical" href="https://code.newban.cn/page/37/">





  <title>乱码三千 – 分享实用IT技术</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
  
<a href="https://www.github.com/songjianzaina" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">乱码三千 – 分享实用IT技术</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">乱码三千 – 码出一个新世界</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="http://www.newban.cn/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https://code.newban.cn/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../29.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../29.html" itemprop="url">如何将python采集到的文章保存到wordpress</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-11T11:03:52+08:00">
                2020-09-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><code>wordpress</code>算是比较流行的博客网站框架, 我本人也一直在使用, 关于<code>python</code>采集文章的上传, 有以下几种方法:</p>
<ol>
<li><strong>直接操作数据库</strong></li>
<li><strong>使用<code>wordpress</code>的<code>rest api</code></strong></li>
<li><strong>使用<code>wordpress_xmlrpc</code>第三方模块</strong></li>
</ol>
<p>其中第三种的体验最为舒适, 对新手友好, 推荐使用</p>
<p>好了 接下来挨个介绍一下这几种方法的使用</p>
<h3 id="直接操作数据库"><a href="#直接操作数据库" class="headerlink" title="直接操作数据库"></a>直接操作数据库</h3><p>我们可以使用<code>python</code>的<code>pymysql</code>库进行<code>mysql</code>数据库的直连操作, 具体不过多介绍, 直接上示例代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql.cursors</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接数据库</span></span><br><span class="line">connect = pymysql.Connect(</span><br><span class="line">    host=<span class="string">'数据库IP'</span>,</span><br><span class="line">    port=<span class="number">3306</span>,</span><br><span class="line">    user=<span class="string">'root'</span>,</span><br><span class="line">    passwd=<span class="string">'xxxx'</span>,</span><br><span class="line">    db=<span class="string">'数据库名称'</span>,</span><br><span class="line">    charset=<span class="string">'utf8mb4'</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取游标</span></span><br><span class="line">cursor = connect.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(post_author, post_date, post_date_gmt,post_content,post_title,post_status,comment_status,ping_status,post_type,menu_order,post_excerpt,to_ping)</span>:</span></span><br><span class="line">    cursor.execute(<span class="string">'INSERT INTO wp_posts (post_author, post_date, post_date_gmt,post_content,post_title,post_status,comment_status,ping_status,post_type,menu_order,post_excerpt)VALUES ( %d, %s,%s, %s,%s, %s,%s, %s,%s,%s, %s, %s)'</span>, (<span class="number">1</span>, post_date, post_date_gmt,post_content,post_title,post_status,comment_status,ping_status,post_type,menu_order,post_excerpt,to_ping))</span><br><span class="line"></span><br><span class="line">    connect.commit()</span><br><span class="line">    print(<span class="string">'成功插入'</span>, cursor.rowcount, <span class="string">'条数据'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="使用wordpress的rest-api"><a href="#使用wordpress的rest-api" class="headerlink" title="使用wordpress的rest api"></a>使用wordpress的rest api</h3><p>关于<code>rest api</code>官方文档如下:</p>
<p><a href="https://developer.wordpress.org/rest-api/" target="_blank" rel="noopener">https://developer.wordpress.org/rest-api/</a></p>
<p><strong>我们先试一下api的威力 格式为</strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://&#123;域名&#125;/index.php/wp-json/wp/v2/posts</span><br></pre></td></tr></table></figure>

<p>比如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.jhcms.net/index.php/wp-json/wp/v2/posts</span><br></pre></td></tr></table></figure>

<p>我们能看到几乎大部分文章的信息</p>
<p><strong>那么如何创建一个新文章</strong></p>
<p>我们参考官方文档 <a href="https://developer.wordpress.org/rest-api/reference/posts/#create-a-post" target="_blank" rel="noopener">https://developer.wordpress.org/rest-api/reference/posts/#create-a-post</a></p>
<p>得到重要信息如下:</p>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><table>
<thead>
<tr>
<th><code>date</code></th>
<th>The date the object was published, in the site’s timezone.</th>
</tr>
</thead>
<tbody><tr>
<td><code>date_gmt</code></td>
<td>The date the object was published, as GMT.</td>
</tr>
<tr>
<td><code>slug</code></td>
<td>An alphanumeric identifier for the object unique to its type.</td>
</tr>
<tr>
<td><code>status</code></td>
<td>A named status for the object. One of: <code>publish</code>, <code>future</code>, <code>draft</code>, <code>pending</code>, <code>private</code></td>
</tr>
<tr>
<td><code>password</code></td>
<td>A password to protect access to the content and excerpt.</td>
</tr>
<tr>
<td><code>title</code></td>
<td>The title for the object.</td>
</tr>
<tr>
<td><code>content</code></td>
<td>The content for the object.</td>
</tr>
<tr>
<td><code>author</code></td>
<td>The ID for the author of the object.</td>
</tr>
<tr>
<td><code>excerpt</code></td>
<td>The excerpt for the object.</td>
</tr>
<tr>
<td><code>featured_media</code></td>
<td>The ID of the featured media for the object.</td>
</tr>
<tr>
<td><code>comment_status</code></td>
<td>Whether or not comments are open on the object. One of: <code>open</code>, <code>closed</code></td>
</tr>
<tr>
<td><code>ping_status</code></td>
<td>Whether or not the object can be pinged. One of: <code>open</code>, <code>closed</code></td>
</tr>
<tr>
<td><code>format</code></td>
<td>The format for the object. One of: <code>standard</code>, <code>aside</code>, <code>chat</code>, <code>gallery</code>, <code>link</code>, <code>image</code>, <code>quote</code>, <code>status</code>, <code>video</code>, <code>audio</code></td>
</tr>
<tr>
<td><code>meta</code></td>
<td>Meta fields.</td>
</tr>
<tr>
<td><code>sticky</code></td>
<td>Whether or not the object should be treated as sticky.</td>
</tr>
<tr>
<td><code>template</code></td>
<td>The theme file to use to display the object. One of:``</td>
</tr>
<tr>
<td><code>categories</code></td>
<td>The terms assigned to the object in the category taxonomy.</td>
</tr>
<tr>
<td><code>tags</code></td>
<td>The terms assigned to the object in the post_tag taxonomy.</td>
</tr>
</tbody></table>
<p><code>POST /wp/v2/posts</code> 意为要用<code>post</code>方法提交到<code>/wp/v2/posts</code>这个地址</p>
<p>默认是只读<code>api</code>, 要实现提交数据需要安装插件<code>jwt</code>，安装了<code>jwt</code>后可以请求到<code>token</code>了，然后在<code>rest api</code>中传入<code>token</code>信息，系统就不会拒绝你的发布文章的操作了</p>
<h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><ol>
<li><p>第一步 在<code>wordpress</code>管理后台安装 <code>JWT Auth</code> 插件</p>
</li>
<li><p>第二部 在网站根目录  <strong>.htaccess</strong> 文件中添加如下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RewriteEngine on</span><br><span class="line">RewriteCond %&#123;HTTP:Authorization&#125; ^(.*)</span><br><span class="line">RewriteRule ^(.*) - [E=HTTP_AUTHORIZATION:%1]</span><br><span class="line"></span><br><span class="line">SetEnvIf Authorization &quot;(.*)&quot; HTTP_AUTHORIZATION=$1</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <strong>wp-config.php</strong> 文件中添加如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">define(&apos;JWT_AUTH_SECRET_KEY&apos;, &apos;your-top-secret-key&apos;);//随便填写一个密码</span><br><span class="line">define(&apos;JWT_AUTH_CORS_ENABLE&apos;, true);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Post请求调用<code>http://{你的域名}/wp-json/jwt-auth/v1/token</code>接口获取token</p>
</li>
<li><p>根据token进行文章的发布</p>
</li>
</ol>
<h4 id="核心代码如下"><a href="#核心代码如下" class="headerlink" title="核心代码如下:"></a>核心代码如下:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_token</span><span class="params">()</span>:</span></span><br><span class="line">    session = requests.Session()</span><br><span class="line">    url = <span class="string">'http://sex.newban.cn/wp-json/jwt-auth/v1/token'</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">'username'</span>:<span class="string">"son3g"</span>,</span><br><span class="line">        <span class="string">'password'</span>:<span class="string">"123456"</span></span><br><span class="line">        &#125;</span><br><span class="line">    headers = &#123;<span class="string">'user-agent'</span>: <span class="string">'Mozolla/5.0'</span>,</span><br><span class="line">               &#125;</span><br><span class="line">    resp = session.post(url, data=data, headers=headers, timeout=<span class="number">3335</span>)  <span class="comment"># 请求</span></span><br><span class="line">    r = json.loads(resp.content)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_do_post</span><span class="params">( token =<span class="string">''</span>)</span>:</span></span><br><span class="line">        session = requests.Session()</span><br><span class="line">        url = <span class="string">'http://sex.newban.cn/wp-json/wp/v2/posts'</span></span><br><span class="line">        data = &#123;</span><br><span class="line">                <span class="string">'date'</span>: time.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>, time.localtime()),</span><br><span class="line">                <span class="string">'date_gmt'</span>: time.strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>, time.gmtime()),</span><br><span class="line">                <span class="string">'slug'</span>: <span class="string">'xx'</span>,</span><br><span class="line">                <span class="string">'status'</span>: <span class="string">'publish'</span>,</span><br><span class="line">                <span class="string">'password'</span>: <span class="string">''</span>,</span><br><span class="line">                <span class="string">'title'</span>: <span class="string">'rest api发布post测试'</span>,</span><br><span class="line">                <span class="string">'content'</span>: <span class="string">'系统测试我想我是海冬天的大海'</span>,</span><br><span class="line">                <span class="string">'author	'</span>: <span class="string">'121852835@qq.com'</span>,</span><br><span class="line">                <span class="string">'excerpt'</span>: <span class="string">''</span>,</span><br><span class="line">                <span class="string">'featured_media'</span>: <span class="string">'0'</span>,</span><br><span class="line">                <span class="string">'comment_status'</span>: <span class="string">'open'</span>,</span><br><span class="line">                <span class="string">'ping_status'</span>: <span class="string">'closed'</span>,</span><br><span class="line">                <span class="string">'format'</span>: <span class="string">'standard'</span>,</span><br><span class="line">                <span class="string">'meta'</span>: [],</span><br><span class="line">                <span class="string">'sticky'</span>: <span class="literal">False</span>,  <span class="comment"># 置顶</span></span><br><span class="line">                <span class="string">'template'</span>: <span class="string">''</span>,</span><br><span class="line">                <span class="string">'categories'</span>: <span class="string">'1'</span>,  <span class="comment"># 1 未分类</span></span><br><span class="line">                <span class="string">'tags'</span>: <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">        headers = &#123;<span class="string">'user-agent'</span>: <span class="string">'Mozolla/5.0'</span>,</span><br><span class="line">                   <span class="string">'Authorization'</span>: <span class="string">'Bearer '</span> + token</span><br><span class="line">                   &#125;</span><br><span class="line">        resp = session.post(url, data=data, headers=headers, timeout=<span class="number">3335</span>)  <span class="comment"># 请求</span></span><br><span class="line">        <span class="keyword">print</span> (resp.text)</span><br><span class="line">        <span class="comment"># r = json.loads(resp.content, 'utf-8')</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if r["code"] == 400:</span></span><br><span class="line">        <span class="comment">#         print r["code"]</span></span><br><span class="line">        <span class="comment">#         print r["message"]</span></span><br><span class="line">        <span class="comment">#         print r["data"]</span></span><br><span class="line">        <span class="comment">#         print r["data"]["status"]</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#         # print r["data"]["params"]</span></span><br><span class="line">        <span class="comment">#         for key in r["data"]["params"]:</span></span><br><span class="line">        <span class="comment">#             print ("%s=&gt; %s" % (key, r["data"]["params"][key]))</span></span><br><span class="line">        <span class="comment">#         # print 'resp.text=&gt;' + resp.text</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#         # print time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(time.time()))</span></span><br><span class="line">        <span class="comment">#         # print time.strftime('%a, %d %b %Y %H:%M:%S GMT+0800 (CST)',time.localtime(time.time())),</span></span><br><span class="line">        <span class="comment">#         dt = formatdate(None, usegmt=True)</span></span><br><span class="line">        <span class="comment">#         dt1 = formatdate(None, usegmt=False)</span></span><br><span class="line">        <span class="comment">#         dt3 = formatdate()</span></span><br><span class="line">        <span class="comment">#         print(dt)</span></span><br><span class="line">        <span class="comment">#         print(dt1)</span></span><br><span class="line">        <span class="comment"># else:</span></span><br><span class="line">        <span class="comment">#         print r["code"]</span></span><br><span class="line">        <span class="comment">#         print r["message"]</span></span><br><span class="line">        <span class="comment">#         print resp.status_code</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">        r = get_token()</span><br><span class="line">        <span class="keyword">print</span> (r)</span><br><span class="line">        _do_post(r[<span class="string">"data"</span>][<span class="string">'token'</span>])</span><br></pre></td></tr></table></figure>

<h3 id="使用wordpress-xmlrpc第三方模块"><a href="#使用wordpress-xmlrpc第三方模块" class="headerlink" title="使用wordpress_xmlrpc第三方模块"></a>使用<code>wordpress_xmlrpc</code>第三方模块</h3><p>操作步骤如下:</p>
<ol>
<li><p>安装<code>wordpress_xmlrpc</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-wordpress-xmlrpc</span><br></pre></td></tr></table></figure>
</li>
<li><p>模块引入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> wordpress_xmlrpc <span class="keyword">import</span> Client, WordPressPost</span><br><span class="line"><span class="keyword">from</span> wordpress_xmlrpc.methods.posts <span class="keyword">import</span> GetPosts,NewPost</span><br></pre></td></tr></table></figure>
</li>
<li><p>发布新文章</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">push_article</span><span class="params">(post_title,post_content_html)</span>:</span></span><br><span class="line">    post = WordPressPost()</span><br><span class="line">    post.title = post_title</span><br><span class="line">    post.slug = post_title</span><br><span class="line">    post.content = post_content_html</span><br><span class="line">    post.terms_names = &#123;</span><br><span class="line">      <span class="string">'post_tag'</span>: post_title.split(<span class="string">" "</span>),</span><br><span class="line">      <span class="string">'category'</span>: [<span class="string">"itarticle"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    post.post_status = <span class="string">'publish'</span></span><br><span class="line">    wp.call(NewPost(post))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    push_article(<span class="string">"文章标题"</span>,<span class="string">"文章内容"</span>)</span><br></pre></td></tr></table></figure>

<p>属性介绍:</p>
<ul>
<li><strong>title</strong>: 文章标题</li>
<li><strong>content</strong>: 文章正文</li>
<li><strong>post_status</strong>: 文章状态，不写默认是草稿，private表示私密的，draft表示草稿，publish表示发布</li>
<li><strong>terms_names</strong>: 设置文章的标签 tag等</li>
<li><strong>slug</strong>: 文章别名</li>
</ul>
</li>
</ol>
<p>完整代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> wordpress_xmlrpc <span class="keyword">import</span> Client, WordPressPost</span><br><span class="line"><span class="keyword">from</span> wordpress_xmlrpc.methods.posts <span class="keyword">import</span> GetPosts,NewPost</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">push_article</span><span class="params">(post_title,post_content_html)</span>:</span></span><br><span class="line">    post = WordPressPost()</span><br><span class="line">    post.title = post_title</span><br><span class="line">    post.slug = post_title</span><br><span class="line">    post.content = post_content_html</span><br><span class="line">    post.terms_names = &#123;</span><br><span class="line">      <span class="string">'post_tag'</span>: post_title.split(<span class="string">" "</span>),</span><br><span class="line">      <span class="string">'category'</span>: [<span class="string">"itarticle"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    post.post_status = <span class="string">'publish'</span></span><br><span class="line">    wp.call(NewPost(post))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    push_article(<span class="string">"文章标题"</span>,<span class="string">"文章内容"</span>)</span><br></pre></td></tr></table></figure>

<p>是不是很简单呢, 如果是批量上传的话, 直接一个循环调用即可</p>
<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../25.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../25.html" itemprop="url">Django创建数据库常用字段及参数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-10T11:05:52+08:00">
                2020-09-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="常用字段"><a href="#常用字段" class="headerlink" title="常用字段"></a>常用字段</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">1、models.AutoField　　自增列= int(11)</span><br><span class="line">　　如果没有的话，默认会生成一个名称为 id 的列，如果要显示的自定义一个自增列，必须将给列设置为主键 primary_key=True。</span><br><span class="line">　　</span><br><span class="line">　　</span><br><span class="line">2、models.CharField　　字符串字段</span><br><span class="line">　　必须 max_length 参数</span><br><span class="line">　　</span><br><span class="line">3、models.BooleanField　　布尔类型=tinyint(1)</span><br><span class="line">　　不能为空，Blank=True</span><br><span class="line">　　</span><br><span class="line">4、models.ComaSeparatedIntegerField　　用逗号分割的数字=varchar</span><br><span class="line">　　继承CharField，所以必须 max_lenght 参数</span><br><span class="line">　　</span><br><span class="line">5、models.DateField　　日期类型 date</span><br><span class="line">　　对于参数，auto_now =True则每次更新都会更新这个时间；auto_now_add 则只是第一次创建添加，之后的更新不再改变。</span><br><span class="line">　　</span><br><span class="line">6、models.DateTimeField　　日期类型 datetime</span><br><span class="line">　　同DateField的参数</span><br><span class="line">　　</span><br><span class="line">7、models.Decimal　　十进制小数类型= decimal</span><br><span class="line">　　必须指定整数位max_digits和小数位decimal_places</span><br><span class="line">　　</span><br><span class="line">8、models.EmailField　　字符串类型（正则表达式邮箱）=varchar</span><br><span class="line">　　对字符串进行正则表达式</span><br><span class="line">　　</span><br><span class="line">9、models.FloatField　　浮点类型= double</span><br><span class="line"></span><br><span class="line">10、models.IntegerField　　整形</span><br><span class="line"></span><br><span class="line">11、models.BigIntegerField　　长整形</span><br><span class="line">　　integer_field_ranges =&#123;</span><br><span class="line">　　　　&apos;SmallIntegerField&apos;:(-32768,32767),</span><br><span class="line">　　　　&apos;IntegerField&apos;:(-2147483648,2147483647),</span><br><span class="line">　　　　&apos;BigIntegerField&apos;:(-9223372036854775808,9223372036854775807),</span><br><span class="line">　　　　&apos;PositiveSmallIntegerField&apos;:(0,32767),</span><br><span class="line">　　　　&apos;PositiveIntegerField&apos;:(0,2147483647),</span><br><span class="line">　　&#125;</span><br><span class="line">　　</span><br><span class="line">12、models.IPAddressField　　字符串类型（ip4正则表达式）</span><br><span class="line"></span><br><span class="line">13、models.GenericIPAddressField　　字符串类型（ip4和ip6是可选的）</span><br><span class="line">　　参数protocol可以是：both、ipv4、ipv6</span><br><span class="line">　　验证时，会根据设置报错</span><br><span class="line">　　</span><br><span class="line">14、models.NullBooleanField　　允许为空的布尔类型</span><br><span class="line"></span><br><span class="line">15、models.PositiveIntegerFiel　　正Integer</span><br><span class="line"></span><br><span class="line">16、models.PositiveSmallIntegerField　　正smallInteger</span><br><span class="line"></span><br><span class="line">17、models.SlugField　　减号、下划线、字母、数字</span><br><span class="line"></span><br><span class="line">18、models.SmallIntegerField　　数字</span><br><span class="line">　　数据库中的字段有：tinyint、smallint、int、bigint</span><br><span class="line">　　</span><br><span class="line">19、models.TextField　　字符串=longtext</span><br><span class="line"></span><br><span class="line">20、models.TimeField　　时间 HH:MM[:ss[.uuuuuu]]</span><br><span class="line"></span><br><span class="line">21、models.URLField　　字符串，地址正则表达式</span><br><span class="line"></span><br><span class="line">22、models.BinaryField　　二进制</span><br><span class="line"></span><br><span class="line">23、models.ImageField  图片</span><br><span class="line"></span><br><span class="line">24、models.FilePathField  文件</span><br></pre></td></tr></table></figure>

<h2 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">1、null=True</span><br><span class="line">　　数据库中字段是否可以为空</span><br><span class="line">　　</span><br><span class="line">2、blank=True</span><br><span class="line">　　django的Admin中添加数据时是否可允许空值</span><br><span class="line">　　</span><br><span class="line">3、primary_key =False</span><br><span class="line">　　主键，对AutoField设置主键后，就会代替原来的自增 id 列</span><br><span class="line">　　</span><br><span class="line">4、auto_now 和 auto_now_add</span><br><span class="line">　　auto_now 自动创建---无论添加或修改，都是当前操作的时间</span><br><span class="line">　　auto_now_add 自动创建---永远是创建时的时间</span><br><span class="line">　　</span><br><span class="line">5、choices</span><br><span class="line">GENDER_CHOICE =(</span><br><span class="line">(u&apos;M&apos;, u&apos;Male&apos;),</span><br><span class="line">(u&apos;F&apos;, u&apos;Female&apos;),</span><br><span class="line">) </span><br><span class="line">gender = models.CharField(max_length=2,choices = GENDER_CHOICE)  #字段模板展示</span><br><span class="line"></span><br><span class="line">6、max_length  最大长度</span><br><span class="line"></span><br><span class="line">7、default　　默认值</span><br><span class="line"></span><br><span class="line">8、verbose_name　　Admin中字段的显示名称</span><br><span class="line"></span><br><span class="line">9、name|db_column　　数据库中的字段名称</span><br><span class="line"></span><br><span class="line">10、unique=True　　不允许重复</span><br><span class="line"></span><br><span class="line">11、db_index =True　　数据库索引</span><br><span class="line"></span><br><span class="line">12、editable=True　　在Admin里是否可编辑</span><br><span class="line"></span><br><span class="line">13、error_messages=None　　错误提示</span><br><span class="line"></span><br><span class="line">14、auto_created=False　　自动创建</span><br><span class="line"></span><br><span class="line">15、help_text　　在Admin中提示帮助信息</span><br><span class="line"></span><br><span class="line">16、validators=[]  验证器</span><br><span class="line"></span><br><span class="line">17、upload-to    重定义上传文件的路径前缀</span><br></pre></td></tr></table></figure>

<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../34.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../34.html" itemprop="url">Mac平台下使用Charles进行抓包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-08T14:48:35+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p> 某天，突然产生了对手机访问进行抓包的想法，<code>google</code>了一下，发现在<code>mac</code>下使用<code>charles</code>进行手机访问的抓包比较容易，就进行了一次手机抓包的尝试（安卓手机）。</p>
<p><strong>这里强调一下 安卓应用抓包建议使用<code>Android7.0</code>以下的模拟器进行操作, 否则HTTPS协议的请求可能存在<code>443</code>无法抓取情况</strong></p>
<h3 id="mac安装charles"><a href="#mac安装charles" class="headerlink" title="mac安装charles"></a>mac安装charles</h3><p> 对于<code>mac</code>下安装<code>charles</code>，网上教程很多，这里不再进行说明，如果有条件的话，最好进行购买。</p>
<h3 id="charles捕获http请求"><a href="#charles捕获http请求" class="headerlink" title="charles捕获http请求"></a>charles捕获http请求</h3><p> 1、<strong>Proxy – macOS</strong> Proxy 先打开代理，使得mac上所有请求都通过charles进行代理。 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200908145123.png" alt></p>
<p> 2、<strong>Proxy – Proxy Settings</strong> 设置监听端口号为8888。</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/hWPSUBakNF97n12.png" alt></p>
<p> 3、此时，用电脑访问百度，就已经可以获取访问的包了，如果我们需要监听手机的访问，就还得在手机上进行设置。 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/wQbUoSWAdhlP52J.png" alt></p>
<p> 4、先获取电脑的ip地址，<strong>Help – Local Ip Address</strong> <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/BOIz4r5VSdRFAgW.png" alt></p>
<p> 5、然后在手机连接wifi，此时手机和电脑连接的必须是同一个wifi，然后在手机设置代理。 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/bdZgW19vieRu3LM.png" alt></p>
<p>6、设置完成后，在手机打开一个网址，此时chartles就可以获取到手机访问的包了。</p>
<h3 id="charles捕获https请求"><a href="#charles捕获https请求" class="headerlink" title="charles捕获https请求"></a>charles捕获https请求</h3><p> http的请求我们已经可以获取，但是有些网站是https的，如果我们需要解析https的包，就需要安装证书了。</p>
<p> 1、<strong>Help – SSL Proxying – install Charles Root Certificate</strong>,首先在mac安装CA证书。 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/FrVcvGhgWL7CB5T.png" alt></p>
<p> 2、然后要始终信任该证书。 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/ibw5QkjI4g8DLEA.png" alt></p>
<p> 3、<strong>Help – SSL Proxying – Install Charles Root Certificate On …</strong>,然后生成手机上的证书。</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/5RkQIY1svdKUDbN.png" alt></p>
<p> 4、<strong>Help – SSL Proxying – Save …</strong>,然后保存该证书，它会生成一个类似<strong>charles-ssl-proxying.pem</strong>的文件，把该文件的后缀改为<strong>.crt</strong>,然后发送到你的安卓手机，进行安装即可。 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/lRA2w4Go5YjLqb8.png" alt></p>
<p> 5、<strong>Proxy – SSL Proxying setting</strong>,设置你要监听的https请求的网址 <img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/GY2pOr1ktqWla9i.png" alt></p>
<p> 6、手机再访问该网址，即可以抓到https的包了。</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/elVRwzuWX4Jsc32.png" alt></p>
<h3 id="APP安装报错解决"><a href="#APP安装报错解决" class="headerlink" title="APP安装报错解决"></a>APP安装报错解决</h3><h4 id="1-如果出现打开时提示：xxx-app已损坏，无法打开-那么输入以下指令解决"><a href="#1-如果出现打开时提示：xxx-app已损坏，无法打开-那么输入以下指令解决" class="headerlink" title="1. 如果出现打开时提示：xxx.app已损坏，无法打开,那么输入以下指令解决:"></a>1. 如果出现打开时提示：xxx.app已损坏，无法打开,那么输入以下指令解决:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo xattr -d com.apple.quarantine /Applications/xxx.app</span><br></pre></td></tr></table></figure>

<p>其中<code>xxx.app</code>是出问题的APP名称，如名称中有空格，可用“\”加空格代替</p>
<h4 id="2-如果报错"><a href="#2-如果报错" class="headerlink" title="2.如果报错"></a>2.如果报错</h4><blockquote>
<p>Charles cannot configure your proxy settings while it is on a read-only volume. Perhaps you are running Charles from the disk image? If so, please copy Charles to the Applications folder and run it again. Otherwise please ensure that Charles is running on a volume that is read-write and try again.</p>
</blockquote>
<h4 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R root &quot;/Applications/Charles.app/Contents/Resources&quot;</span><br><span class="line"> sudo chmod -R u+s &quot;/Applications/Charles.app/Contents/Resources&quot;</span><br></pre></td></tr></table></figure>

<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../21.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../21.html" itemprop="url">Ajax 跨域问题及其解决方案</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-08T11:14:22+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是-ajax-跨域"><a href="#什么是-ajax-跨域" class="headerlink" title="什么是 ajax 跨域"></a>什么是 ajax 跨域</h2><p>主流的<strong>前后端分离模式</strong>下，当前端调用后台接口时，由于是在非同一个域下的请求，从而会引发<strong>浏览器</strong>的自我安全保护机制，最终结果是<strong>接口成功请求并响应</strong>，但<strong>前端不能正常处理该返回数据</strong>。</p>
<p><img src="https://i.loli.net/2020/09/08/EGern4xhRwqF7gU.png" alt="Access-Control-Allow-Origin"></p>
<p>因此，当<strong>同时满足</strong>以下三个条件的情况下，就会出现跨域问题：</p>
<ol>
<li>浏览器限制</li>
<li>非同源请求（跨域）</li>
<li>发送的是 XHR ( XMLHttpRequest ) 请求</li>
</ol>
<p><img src="https://i.loli.net/2020/09/08/u8D62HznvwgcM1W.png" alt="跨域问题"></p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>想要彻底解决跨域问题，只需要破坏以上三个条件的任一即可：</p>
<h4 id="1-修改浏览器（不推荐）"><a href="#1-修改浏览器（不推荐）" class="headerlink" title="1. 修改浏览器（不推荐）"></a>1. 修改浏览器（<strong>不推荐</strong>）</h4><p>添加浏览器启动参数：<code>chrome --disable-web-security</code>，但是极不推荐这种解决方式。</p>
<h4 id="2-JSONP请求（不常用）"><a href="#2-JSONP请求（不常用）" class="headerlink" title="2. JSONP请求（不常用）"></a>2. JSONP请求（<strong>不常用</strong>）</h4><p>Jsonp，全称 <code>JSON with Padding</code>，一种非官方的协议，而是一种约定；前端通过向后台发送 <code>script</code> 类型请求解决跨域，此时接口响应的 <code>application/javascript</code> 类型的数据会作为 <code>callback</code> 函数的参数进行处理。</p>
<p><img src="https://i.loli.net/2020/09/08/1RqpuXFLGTlMjI7.png" alt="Jsonp Request"></p>
<p>所以，后台也需要做相应的处理。以 Java 为例，添加如下配置即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@ControllerAdvice</span><br><span class="line">public class JsonpAdvice extends AbstractJsonpResponseBodyAdvice &#123;</span><br><span class="line"></span><br><span class="line">    public JsonpAdvice() &#123;</span><br><span class="line">		// 前后端约定的jsonp参数名，默认值是callback</span><br><span class="line">        super(&quot;callback&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意，<code>Spring 4.1</code> 版本之后，官方已不再推荐使用上述允许 <code>jsonp</code> 请求的配置，建议使用 <code>CROS</code> 配置来解决跨域问题，详情可查看<a href="https://docs.spring.io/spring/docs/5.0.x/spring-framework-reference/web.html#mvc-cors" target="_blank" rel="noopener">这里</a></p>
</blockquote>
<p>综上，<code>jsonp</code> 请求存在以下几个弊端：</p>
<ol>
<li>服务端需要改动代码进行支持；</li>
<li>只支持发送 <code>Get</code> 请求，请求头中更改其它类型的请求方式是无效的；</li>
<li>发送的不是 <code>XHR</code> 请求，而是 <code>script</code> 类型，无法享受到相关的特性。</li>
</ol>
<h4 id="3-调用方隐藏跨域"><a href="#3-调用方隐藏跨域" class="headerlink" title="3. 调用方隐藏跨域"></a>3. 调用方隐藏跨域</h4><p>用 <code>Nginx</code> 或 <code>Apache</code> 来代理调用方的请求（<strong>客户端变更为相对路径请求，而非绝对路径</strong>），此时对于浏览器来说，由于请求是同源的，因此就不存在跨域问题。</p>
<h4 id="4-被调用方允许跨域（最常用）"><a href="#4-被调用方允许跨域（最常用）" class="headerlink" title="4. 被调用方允许跨域（最常用）"></a>4. 被调用方允许跨域（<strong>最常用</strong>）</h4><ul>
<li>服务端配置</li>
</ul>
<p>以 Java 应用为例，添加如下全局配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class CorsConfig implements WebMvcConfigurer &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void addCorsMappings(CorsRegistry registry) &#123;</span><br><span class="line">        registry.addMapping(&quot;/**&quot;)  // 允许跨域的接口</span><br><span class="line">                .allowedOrigins(&quot;*&quot;)  // 允许跨域的请求源</span><br><span class="line">                .allowedMethods(&quot;*&quot;)  // 允许跨域的请求方式</span><br><span class="line">                .allowedHeaders(&quot;*&quot;) // 允许跨域的请求头</span><br><span class="line">                .allowCredentials(true)  // 带cookie请求的时候需要开启，且allowedOrigins需要指定为具体的请求源（最好是动态配置）</span><br><span class="line">                .maxAge(60 * 60 * 24); // 设定options请求预检命令的缓存时长</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果只想针对某个类下的接口，或者是某个具体的接口配置允许跨域，只需要在相应的地方添加注解 <code>@CrossOrigin</code> 即可。</p>
<ul>
<li>Nginx 配置</li>
</ul>
<p>如果配置了 <code>nginx</code> 作为代理服务器，那么只需要为 <code>nginx</code> 添加支持跨域请求即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">	listen 80;</span><br><span class="line">	server_name xxx.com;</span><br><span class="line"></span><br><span class="line">	location / &#123;</span><br><span class="line">		proxy_pass http://localhost:8080/;</span><br><span class="line"></span><br><span class="line">		# 配置允许跨域</span><br><span class="line">		add_header Access-Control-Allow-Origin $http_origin;</span><br><span class="line">		add_header Access-Control-Allow-Methods *;</span><br><span class="line">		add_header Access-Control-Allow-Headers $http_access_control_request_headers;</span><br><span class="line">		add_header Access-Control-Max-Age 3600;</span><br><span class="line">		add_header Access-Control-Allow-Credentials true;</span><br><span class="line">		</span><br><span class="line">		# 对于options预检请求，直接响应200</span><br><span class="line">		if ($request_method = OPTIONS) &#123;</span><br><span class="line">			return 200;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="扩展思考"><a href="#扩展思考" class="headerlink" title="扩展思考"></a>扩展思考</h2><p>Q1：浏览器在执行跨域请求时，是先执行后判断，还是先判断后执行？<br>A1：都有可能，这需要根据所发送的请求是<strong>简单请求</strong>还是<strong>非简单请求</strong>来判断；如果是非简单请求，浏览器每次在执行真正的请求之前，还会先发送一个 <code>options</code> 请求方式的预检命令【 <strong>可设定缓存时长，取消每次请求都要预检，提高效率，参考上面的服务端配置</strong> 】。关于两种请求的区分及定义，参考下图说明：</p>
<p><img src="https://i.loli.net/2020/09/08/TWOvdB8wLxclq65.png" alt="简单请求 VS 非简单请求"></p>
<p>Q2：如果是允许带（<strong>被调用方</strong>） <code>cookie</code> 的跨域请求，此时服务端同样配置为 <code>Access-Control-Allow-Origin</code> 等于 <code>*</code>，前端是否还可以请求成功？<br>A2：不可以，此时要将 <code>Access-Control-Allow-Origin</code> 指定为<strong>调用方</strong>具体的域【 <strong>可以先取得调用方的域再动态配置，这样就不存在多个域请求的限制问题</strong> 】，并且添加配置 <code>Access-Control-Allow-Credentials</code> 为 <code>true</code>。</p>
<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../43.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../43.html" itemprop="url">向谷歌搜索引擎主动推送网页的教程 Google Indexing API 接口实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-08T11:04:25+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/jHXAmlIOfwsvtep-20200908110823361.jpg" alt></p>
<p>谷歌搜索引擎作为全球第一的搜索引擎早就支持了站长主动推送的功能，只不过不是面向普通用户的可视化界面，而是通过编程API接口实现的，有很多站长并不是专业的开发者，但由于谷歌需要验证网站所有权，所以我不能直接做一个可视化界面让站长自己填写自己的秘钥，所以只能对谷歌的接口进行二次封装，以降低使用的难度。</p>
<p>源码项目地址：<a href="https://github.com/NeilRen/GoogleIndexing" target="_blank" rel="noopener">https://github.com/NeilRen/GoogleIndexing</a></p>
<h2 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h2><p>首先，我是以Java为平台进行的封装，JDK版本为1.8，其他程序可能需要中间层才能打通，还不如自己实现，其他编程语言的同学我也没有办法，这个世界上编程语言太多了。</p>
<p>其次，谷歌的Google Indexing API接口在中国大陆无法访问，所以程序需要运行在可以访问谷歌的网络环境中。</p>
<h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><p>首先，你需要一个谷歌账号。你的项目是Java的，并且JDK为1.8以上。</p>
<h2 id="创建-Google-API-项目"><a href="#创建-Google-API-项目" class="headerlink" title="创建 Google API 项目"></a>创建 Google API 项目</h2><p>然后在向 Indexing API 发送请求之前，您需要告知 Google 您的客户端并激活对 Indexing API 的访问权限。谷歌为我们提供了一个<a href="https://console.developers.google.com/start/api?id=indexing.googleapis.com&credential=client_key" target="_blank" rel="noopener">设置向导</a>，设置向导会引导您在 Google API 控制台中创建项目、启用 Indexing API 以及创建凭据。</p>
<p>首先先跟着向导创建一个项目</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/M2ptE4nOaW6Z3qg.png" alt="Google Indexing API 设置向导"></p>
<p>然后转到凭据，添加凭据</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210556-20200908110850707.png" alt="Google Indexing API 添加凭证"></p>
<p>添加的凭据选择Indexing API、网页服务器(例如 node.js、Tomecat)，选择应用数据，点击“我需要哪些凭据？”到下一页</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210605-20200908110904033.png" alt="Google Indexing API 为项目添加凭证"></p>
<p>创建一个服务账号，名称可以自己起一个名字，秘钥类型选择JSON，点击继续</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210613-20200908110918941.png" alt="Google Indexing API 创建服务账号"></p>
<p>选择创建无角色账号即可</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210621-20200908110933400.png" alt="Google Indexing API 创建无角色账号"></p>
<p>这时就会自动下载一个json文件，这个就是我们的私钥，要保存好</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210628-20200908110944503.png" alt="Google Indexing API 秘钥"></p>
<h2 id="在-Search-Console-中验证网站所有权"><a href="#在-Search-Console-中验证网站所有权" class="headerlink" title="在 Search Console 中验证网站所有权"></a>在 Search Console 中验证网站所有权</h2><p>我们还需要到 <a href="https://www.google.com/webmasters/tools/home" target="_blank" rel="noopener">Search Console</a> 添加我们的网站，验证所有权，验证成功以后，注意我们要去<a href="https://www.google.com/webmasters/verification/home?pli=1" target="_blank" rel="noopener">旧版的控制台</a>，不要去新版的控制台！然后添加所有者</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210643-20200908110957641.png" alt="Google 旧版控制台">]</p>
<p>所有者的邮箱填写我们上一步获得的私钥JSON文件中的邮箱地址。</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210636-20200908111008115.png" alt="Google Indexing API 秘钥JSON"><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200310210654-20200908111018700.png" alt="Google 添加网站所有者"></p>
<h2 id="在自己的项目中安装依赖"><a href="#在自己的项目中安装依赖" class="headerlink" title="在自己的项目中安装依赖"></a>在自己的项目中安装依赖</h2><p>如果您使用Apache Maven来管理Java项目，只需在项目的<code>pom.xml</code>文件加入相应的依赖项即可。您只需在<code>pom.xml</code>中声明以下依赖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;net.renfei&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;googleindexing&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>编写代码调用服务，在实例化GoogleIndexing的时候，需要传一个String参数，这个参数是私钥JSON文件所在的文件地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import com.alibaba.fastjson.JSON;</span><br><span class="line">import com.google.api.services.indexing.v3.model.UrlNotificationMetadata;</span><br><span class="line">import net.renfei.googleindexing.GoogleIndexing;</span><br><span class="line">import net.renfei.googleindexing.entity.UrlNotification;</span><br><span class="line">import net.renfei.googleindexing.entity.UrlNotificationType;</span><br><span class="line"></span><br><span class="line">public class Demo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            GoogleIndexing googleIndexing = new GoogleIndexing(&quot;/Users/renfei/Google/Ren-Fei-5a8df7c2b912.json&quot;);</span><br><span class="line">            UrlNotification urlNotification = new UrlNotification();</span><br><span class="line">            urlNotification.setUrl(&quot;https://www.renfei.net&quot;);</span><br><span class="line">            urlNotification.setType(UrlNotificationType.URL_UPDATED);</span><br><span class="line">            UrlNotificationMetadata urlNotificationMetadata = googleIndexing.publish(urlNotification);</span><br><span class="line">            System.out.printf(JSON.toJSONString(urlNotificationMetadata));</span><br><span class="line">        &#125; catch (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../32.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../32.html" itemprop="url">Hugo博客百度SEO优化 自动提交</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-08T10:43:23+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在切换到Hugo平台之后,比较头疼的是之前hexo很多seo的插件不能使用了. 下面跟大家说一下我的seo优化方案.</p>
<h1 id="Meta标签优化"><a href="#Meta标签优化" class="headerlink" title="Meta标签优化"></a>Meta标签优化</h1><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>meta description，被认为是最有用的meta标签，是网站的简介信息。 content控制在100个字符以内比较好。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">'description'</span> <span class="attr">itemprop</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"&#123;&#123; if .Description &#125;&#125;&#123;&#123; .Description &#125;&#125;&#123;&#123; else &#125;&#125;&#123;&#123;if .IsPage&#125;&#125;&#123;&#123;substr .Summary 0 100&#125;&#125;&#123;&#123; end &#125;&#125;&#123;&#123; end &#125;&#125;"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Keywords"><a href="#Keywords" class="headerlink" title="Keywords"></a>Keywords</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; if .Keywords &#125;&#125; </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"&#123;&#123; delimit .Keywords "</span>, " &#125;&#125;" &gt;</span></span><br><span class="line">&#123;&#123;else&#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"&#123;&#123; delimit .Site.Params.Keywords "</span>, " &#125;&#125;" &gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="百度熊掌号推送"><a href="#百度熊掌号推送" class="headerlink" title="百度熊掌号推送"></a>百度熊掌号推送</h1><p>说到seo熊掌号是必不可少的了,他可以做到24小时之内收录.所以这个必须不能放过.</p>
<h2 id="gulp"><a href="#gulp" class="headerlink" title="gulp"></a>gulp</h2><p>在这里我要使用gulp来做我的自动化任务管理工具</p>
<h3 id="安装gulp需要的模块"><a href="#安装gulp需要的模块" class="headerlink" title="安装gulp需要的模块"></a>安装gulp需要的模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br><span class="line">npm install gulp --save</span><br><span class="line">npm install xml2js --save</span><br><span class="line">npm install xmlhttprequest --save</span><br></pre></td></tr></table></figure>

<h3 id="在项目根目录创建一个gulpfile-js文件"><a href="#在项目根目录创建一个gulpfile-js文件" class="headerlink" title="在项目根目录创建一个gulpfile.js文件"></a>在项目根目录创建一个<code>gulpfile.js</code>文件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入相关依赖</span></span><br><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">"gulp"</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> xml2js = <span class="built_in">require</span>(<span class="string">'xml2js'</span>)</span><br><span class="line"><span class="keyword">const</span> parser = <span class="keyword">new</span> xml2js.Parser();</span><br><span class="line"><span class="keyword">const</span> XMLHttpRequest = <span class="built_in">require</span>(<span class="string">"xmlhttprequest"</span>).XMLHttpRequest;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册百度站长与熊掌号,百度会提供下面的数据给你</span></span><br><span class="line"><span class="keyword">var</span> xz_appid = <span class="string">'1623792852327580'</span>;</span><br><span class="line"><span class="keyword">var</span> xz_token = <span class="string">'bbd1f589b763b7fb40e52628c176ae27'</span>;</span><br><span class="line"><span class="keyword">var</span> baidu_token= <span class="string">'79IKQsDuvZSdXwd9'</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">//熊掌号每天需要提交的url数量</span></span><br><span class="line"><span class="comment">// 注意这个数字必须要跟百度允许提交的url数量一致,如果多了会提交失败.</span></span><br><span class="line"><span class="keyword">const</span> xzCount = <span class="number">2000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个任务</span></span><br><span class="line">gulp.task(<span class="string">'baiduSeo'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 读取sitemap.xml文件并且转换成json</span></span><br><span class="line">    fs.readFile(__dirname + <span class="string">'/public/sitemap.xml'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        parser.parseString(data, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 把读取的数据传入这个函数</span></span><br><span class="line">            urlSubmit(result.urlset.url)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'Done'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 提交url的方法</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">urlSubmit</span>(<span class="params">urls</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 最新内容提交</span></span><br><span class="line">    <span class="keyword">var</span> new_target = <span class="string">"http://data.zz.baidu.com/urls?appid="</span>+xz_appid+<span class="string">"&amp;token="</span>+xz_token+<span class="string">"&amp;type=realtime"</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 历史提交</span></span><br><span class="line">    <span class="keyword">var</span> history_target = <span class="string">"http://data.zz.baidu.com/urls?appid="</span>+xz_appid+<span class="string">"&amp;token="</span>+xz_token+<span class="string">"&amp;type=batch"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 百度站长</span></span><br><span class="line">    <span class="keyword">var</span> baidu_target = <span class="string">"http://data.zz.baidu.com/urls?site=https://zaina.newban.cn&amp;token="</span>+baidu_token</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MIP</span></span><br><span class="line">    <span class="keyword">var</span> MIP_target = <span class="string">"http://data.zz.baidu.com/urls?site=https://zaina.newban.cn&amp;token="</span>+baidu_token+<span class="string">"&amp;type=mip"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// AMP</span></span><br><span class="line">    <span class="keyword">var</span> AMP_target = <span class="string">"http://data.zz.baidu.com/urls?site=https://zaina.newban.cn&amp;token="</span>+baidu_token+<span class="string">"&amp;type=amp"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最新url,看熊掌号情况而定</span></span><br><span class="line">    urls = urls.map(<span class="function"><span class="params">item</span>=&gt;</span>item.loc[<span class="number">0</span>])</span><br><span class="line">    allUrls = urls.join(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> new_urls_Arr = urls.slice(<span class="number">0</span>,xzCount)</span><br><span class="line">    new_urls= new_urls_Arr.join(<span class="string">'\n'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">'百度站长开始提交'</span>,new_urls)</span><br><span class="line">    sendData(baidu_target,new_urls,<span class="string">'百度站长提交成功'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">'熊掌号开始提交'</span>)</span><br><span class="line">    <span class="comment">//sendData(new_target,new_urls,'熊掌号提交完成')</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提交历史url 每天最多500w条</span></span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">"历史数据开始提交"</span>)</span><br><span class="line">    <span class="comment">//sendData(history_target,allUrls,"历史数据提交完成")</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">"MIP 开始提交"</span>)</span><br><span class="line">    <span class="comment">//sendData(MIP_target,allUrls,"MIP提交成功")</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">"AMP 开始提交"</span>)</span><br><span class="line">    <span class="comment">//sendData(AMP_target,allUrls,"AMP提交成功")</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提交数据</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sendData</span>(<span class="params">target,urls,message</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        xhr.open(<span class="string">'POST'</span>, target, <span class="literal">false</span>);</span><br><span class="line">        xhr.setRequestHeader(<span class="string">'Content-type'</span>, <span class="string">'text/plain'</span>);</span><br><span class="line">        xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.responseText);</span><br><span class="line">            <span class="keyword">if</span>(message)&#123;<span class="built_in">console</span>.info(message)&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        xhr.send(urls);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">"default"</span>,gulp.series( <span class="string">'baiduSeo'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;))</span><br></pre></td></tr></table></figure>

<p>配置好以上都文件之后</p>
<h2 id="推送"><a href="#推送" class="headerlink" title="推送"></a>推送</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 博客生成</span></span><br><span class="line">hugo</span><br><span class="line"><span class="comment"># url推送</span></span><br><span class="line">gulp</span><br></pre></td></tr></table></figure>

<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../35.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../35.html" itemprop="url">Python的.sort()方法和sorted（）比较总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-07T10:38:05+08:00">
                2020-09-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1，-sort（）方法"><a href="#1，-sort（）方法" class="headerlink" title="1，.sort（）方法"></a>1，.sort（）方法</h4><p>　　使用方式是：列表.sort(),作用是将原来的列表正序排序，所以它是对原来的列表进行的操作，不会产生一个新列表，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import  random</span><br><span class="line">numList=[]</span><br><span class="line">print(numList)</span><br><span class="line">for i in range(10):</span><br><span class="line">    numList.append(random.randrange(1,10))# 不包括10</span><br><span class="line">print(&quot;未排序的列表：&quot;,numList)</span><br><span class="line"># numList.sort()执行过程是将列表拍完序后又赋值给了原列表</span><br><span class="line">numList.sort()</span><br><span class="line">print(&quot;排序后列表：&quot;,numList)</span><br><span class="line"># 无法将numList.sort()赋值给一个新列表，以为它并不返回一个新列表</span><br><span class="line">numList=numList.sort()</span><br><span class="line">print(&quot;无法赋值给新列表的的结果：&quot;,numList)</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">未排序的列表： [7, 2, 2, 4, 5, 6, 7, 9, 4, 8]</span><br><span class="line">排序后列表： [2, 2, 4, 4, 5, 6, 7, 7, 8, 9]</span><br><span class="line">无法赋值给新列表的的结果： None</span><br></pre></td></tr></table></figure>

<h4 id="2，sorted-列表-是Python内置函数，该函数对原列表不会产生影响，只是在原来列表的基础上，产生一个有序的新列表，可以复制一个列表名"><a href="#2，sorted-列表-是Python内置函数，该函数对原列表不会产生影响，只是在原来列表的基础上，产生一个有序的新列表，可以复制一个列表名" class="headerlink" title="2，sorted(列表),是Python内置函数，该函数对原列表不会产生影响，只是在原来列表的基础上，产生一个有序的新列表，可以复制一个列表名"></a>2，sorted(列表),是Python内置函数，该函数对原列表不会产生影响，只是在原来列表的基础上，产生一个有序的新列表，可以复制一个列表名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import  random</span><br><span class="line">numList=[]</span><br><span class="line">print(numList)</span><br><span class="line">for i in range(10):</span><br><span class="line">    numList.append(random.randrange(1,10))# 不包括10</span><br><span class="line">print(&quot;未排序的列表：&quot;,numList)</span><br><span class="line"></span><br><span class="line">sorted(numList)</span><br><span class="line">print(&quot;sorted排序后的数组，不会对原列表有任何影响：&quot;,numList)</span><br><span class="line">getList=sorted(numList)</span><br><span class="line">print(&quot;sorted获得的新的列表：&quot;,getList)</span><br></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">未排序的列表： [1, 4, 3, 4, 3, 9, 5, 4, 4, 9]</span><br><span class="line">sorted排序后的数组，不会对原列表有任何影响： [1, 4, 3, 4, 3, 9, 5, 4, 4, 9]</span><br><span class="line">sorted获得的新的列表： [1, 3, 3, 4, 4, 4, 4, 5, 9, 9]</span><br></pre></td></tr></table></figure>










<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../23.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../23.html" itemprop="url">App自动化之Appium入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-07T10:28:21+08:00">
                2020-09-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>像<code>Selenium</code>可以操控Web浏览器，手机APP平台也有类似的自动化测试工具：<code>Appium</code>；<br>全文分基础介绍、环境搭建和案例演示三部分介绍<code>Appium</code>，以帮助Learner快速的上手。</p>
</blockquote>
<h3 id="基础介绍"><a href="#基础介绍" class="headerlink" title="基础介绍"></a>基础介绍</h3><p>Appium是一个开源的自动化测试框架，用于原生，混合和移动Web应用程序。 它使用WebDriver协议驱动iOS，Android和Windows应用程序。关于它的运作流程，用图来介绍会更加生动形象一些：</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/Nd9GcRnhRoLusz8RMt6P3dBn_po4ozGjHWB-20200907103239987.png" alt="Appium运行流程、原理"></p>
<p>在上图中，左边这部分是<code>Appium-Client</code>，通俗点来说，是用于间接驱动最右边的设备执行预定的自动化测试流程，支持使用多种主流的编程语言进行编写，这也是测试开发人员需要关注的核心部分；中间的<code>Appium-Server</code>是衔接左边客户端以及右边APP设备端的重要桥梁，一般仅需要配置好环境及启动运行；右边这块，当然就是实际执行自动化测试的终端，如IOS真机、Android真机，或者是模拟器。</p>
<h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><ul>
<li>NodeJS</li>
</ul>
<p>Appium是使用nodejs实现的，因此Node是解释器，首先要确认安装好</p>
<ul>
<li>Appium-Server<ul>
<li>nodejs</li>
<li><a href="https://github.com/appium/appium-desktop/releases" target="_blank" rel="noopener">appium-desktop</a></li>
</ul>
</li>
</ul>
<p>上述的两种方式都可以搭建<code>Appium-Server</code>环境，后面演示会基于Appium-Desktop。(PS：下载太慢了?分享个<a href="https://pan.baidu.com/s/1QQcYcDlOngdFjLhaJWAXCg" target="_blank" rel="noopener">百度网盘</a>)</p>
<ul>
<li>Andrioid SDK<ul>
<li><a href="https://android-sdk.en.softonic.com/" target="_blank" rel="noopener">android sdk</a></li>
<li><a href="https://developer.android.com/studio/" target="_blank" rel="noopener">android studio</a></li>
</ul>
</li>
</ul>
<p>上述方式可以直接和间接搭建安装<code>Android</code>环境，因为后面要用到<code>adb</code>这个工具，所以需要配置好<code>ANDROID_HOME</code>这个环境变量。(PS：下载太慢了?分享个<a href="https://pan.baidu.com/s/1Y7UC8S2Plsieo59MPmQgMw" target="_blank" rel="noopener">百度网盘</a>)</p>
<ul>
<li>Appium-Python-Client</li>
</ul>
<p>后面会用到Python来编写Appium客户端：<code>pip install Appium-Python-Client</code></p>
<p>okay，准备好以上几个环境后，启动Appium测试一下：</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20181030111040-20200907103248988.png" alt="Appium Desktop Server"></p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20181030111212-20200907103257799.png" alt="Appium Desktop Server"></p>
<h3 id="案例演示"><a href="#案例演示" class="headerlink" title="案例演示"></a>案例演示</h3><p>下面演示在安卓真机上的自动登录<code>Keep</code>(APP)。</p>
<ol>
<li>获取设备名称。操作流程：开启手机的开发和调试模式，连接电脑授权认证，<code>Window + R</code>输入并运行<code>cmd</code>，用<code>adb devices -l</code>查看：</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20181030134047-20200907103307894.png" alt="获取设备号"></p>
<ol>
<li>启动Appium Server进行调试：</li>
</ol>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20181030134400-20200907103312054.png" alt="Inspector Session"></p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20181030134702-20200907103318824.png" alt="Desired Capabilities"></p>
<p>从上图可以看到，启动App Session需要有以下几个参数(点击了解更详细的<a href="https://appium.io/docs/en/writing-running-appium/caps/" target="_blank" rel="noopener">Appium Desired Capabilities</a>）:</p>
<ul>
<li><code>platformName</code>，如<code>Android</code>、<code>iOS</code>等</li>
<li><code>deviceName</code>，参考前面是如何获取的</li>
<li><code>appPackage</code>和<code>appActivity</code>，获取<a href="https://blog.csdn.net/mtbaby/article/details/78676477" target="_blank" rel="noopener">参考这里</a></li>
</ul>
<p>综上所述，这里对应<code>Keep</code>的信息如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;platformName&quot;: &quot;Android&quot;,</span><br><span class="line">  &quot;deviceName&quot;: &quot;WAS_AL00&quot;,</span><br><span class="line">  &quot;appPackage&quot;: &quot;com.gotokeep.keep&quot;,</span><br><span class="line">  &quot;appActivity&quot;: &quot;com.gotokeep.keep.splash.SplashActivity&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>点击<code>Start Session</code>，之后可以看到手机端启动了<code>Keep</code>，并且在Appium Server端中同步展示：</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20181030150015-20200907103327336.png" alt="Start Session"></p>
<p><img src="http://image.mariojd.cn/happyjared/20181030/20181030150055.png" alt="Keep"></p>
<p>上述的操作通常只是用来方便获取控件id及定位的，下面基于Python编写完整的<code>Appium-Client</code>以实现自动登录操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">from appium import webdriver</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as EC</span><br><span class="line"></span><br><span class="line">server = &apos;http://localhost:4723/wd/hub&apos;  # Appium Server, 端口默认为4723</span><br><span class="line">desired_capabilities = &#123;</span><br><span class="line">    &apos;platformName&apos;: &apos;Android&apos;,</span><br><span class="line">    &apos;deviceName&apos;: &apos;WAS_AL00&apos;,  # 需替换成你的deviceName</span><br><span class="line">    &apos;appPackage&apos;: &apos;com.gotokeep.keep&apos;,</span><br><span class="line">    &apos;appActivity&apos;: &apos;com.gotokeep.keep.splash.SplashActivity&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">driver = webdriver.Remote(server, desired_capabilities)</span><br><span class="line">wait = WebDriverWait(driver, 10)  # 最大查找等待超时时间：10s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_permission():</span><br><span class="line">    &quot;&quot;&quot;允许APP获取的某些权限&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        ask = wait.until(EC.presence_of_element_located((By.ID, &apos;com.android.packageinstaller:id/do_not_ask_checkbox&apos;)))</span><br><span class="line">        ask.click()</span><br><span class="line">        allow = wait.until(</span><br><span class="line">            EC.presence_of_element_located((By.ID, &apos;com.android.packageinstaller:id/permission_allow_button&apos;)))</span><br><span class="line">        allow.click()</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 允许两项授权</span><br><span class="line">get_permission()</span><br><span class="line">get_permission()</span><br><span class="line"></span><br><span class="line"># 点击“立即使用”</span><br><span class="line">welcome = wait.until(EC.presence_of_element_located((By.ID, &apos;com.gotokeep.keep:id/btn_bottom_in_video_welcome&apos;)))</span><br><span class="line">welcome.click()</span><br><span class="line"></span><br><span class="line"># 切换“密码登录”(同样可以使用第三方进行授权登录)</span><br><span class="line">driver.tap([(900, 110)])</span><br><span class="line"></span><br><span class="line"># 输入“手机号”</span><br><span class="line">phone = driver.find_element_by_accessibility_id(&apos;Phone Number In Login&apos;)</span><br><span class="line">phone.send_keys(&apos;13988888888&apos;)  # 替换成实际的账号</span><br><span class="line"></span><br><span class="line"># 输入“密码”</span><br><span class="line">password = driver.find_element_by_accessibility_id(&apos;Password In Login&apos;)</span><br><span class="line">password.send_keys(&apos;123456&apos;)  # 替换成实际的密码</span><br><span class="line"></span><br><span class="line"># 点击“登录”</span><br><span class="line">login = driver.find_element_by_id(&apos;com.gotokeep.keep:id/btn_action&apos;)</span><br><span class="line">login.click()</span><br></pre></td></tr></table></figure>

<p>最后，附上运行效果图：</p>
<p><img src="http://image.mariojd.cn/happyjared/20181030/20181030160014.gif" alt="效果图"></p>
<p><strong>本文转载自;<a href="https://blog.mariojd.cn/get-started-with-appium.html" target="_blank" rel="noopener">https://blog.mariojd.cn/get-started-with-appium.html</a></strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../36.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../36.html" itemprop="url">Python跨平台之将Python 程序打包成Windows和Linux可执行文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-07T10:19:13+08:00">
                2020-09-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>通常执行 python 程序要有相应的 Python 环境，但某些特定场景下，我们可能并不愿意这么麻烦的去配置这些环境（比如将写好的脚本发给客户进行操作），如果可以提前将程序打包成 Windows平台的 <code>.exe</code> 文件或者是Linux下的 <code>.sh</code> 脚本，那么使用起来就会方便很多，py2exe 和 PyInstaller 这两款工具都是干这么个事的，下面以 hello.py 脚本（代码内容如下）为例进行介绍。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age = input(<span class="string">"How old are you?\n"</span>)</span><br><span class="line">print(<span class="string">"A: "</span> + age)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>提示：PyInstaller 可以在 Windows 和 Linux 下使用，更推荐使用，而 py2exe 暂不支持 Linux 平台 而且只支持python低版本环境</p>
</blockquote>
<h3 id="PyInstaller"><a href="#PyInstaller" class="headerlink" title="PyInstaller"></a>PyInstaller</h3><ol>
<li>安装</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyinstaller</span><br></pre></td></tr></table></figure>

<ol>
<li>使用</li>
</ol>
<p>常见的用法有：</p>
<ul>
<li>生成单个可执行文件：<code>pyinstaller -F hello.py</code></li>
<li>生成指定icon的可执行文件：<code>pyinstaller -i xxx.ico hello.py</code></li>
</ul>
<blockquote>
<p>在当前目录下的 dist 文件夹内可以找到生成后的可执行文件（脚本），更多用法请参考说明</p>
</blockquote>
<h3 id="py2exe"><a href="#py2exe" class="headerlink" title="py2exe"></a><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fpypi.org%2Fproject%2Fpy2exe%2F" target="_blank" rel="noopener">py2exe</a></h3><ol>
<li>安装</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install py2exe</span><br></pre></td></tr></table></figure>

<ol>
<li>使用</li>
</ol>
<p>如上图，打包失败了，留意到<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F41578808%2Fpython-indexerror-tuple-index-out-of-range-when-using-py2exe" target="_blank" rel="noopener">这里</a>说不支持 python3.6，果断放弃，有兴趣的可以自行降低到 python3.4 或 python3.5 进行尝试。</p>
<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://code.newban.cn../../39.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱码三千">
      <meta itemprop="description" content>
      <meta itemprop="image" content="../../images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="乱码三千 – 分享实用IT技术">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="../../39.html" itemprop="url">wireshark怎么抓包、wireshark抓包详细图文教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-07T10:13:24+08:00">
                2020-09-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>wireshark是非常流行的网络封包分析软件，功能十分强大。可以截取各种网络封包，显示网络封包的详细信息。使用wireshark的人必须了解网络协议，否则就看不懂wireshark了。<br>为了安全考虑，wireshark只能查看封包，而不能修改封包的内容，或者发送封包。</p>
<p>wireshark能获取HTTP，也能获取HTT<a href="http://www.cr173.com/k/photoshopcs5/" target="_blank" rel="noopener">PS</a>，但是不能解密HTTPS，所以wireshark看不懂HTTPS中的内容，总结，如果是处理HTTP,HTTPS 还是用Fiddler, <strong>其他协议比如TCP,UDP 就用wireshark.</strong></p>
<p><strong>wireshark 开始抓包</strong></p>
<p>开始界面</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314094522754-103175516-20200907102049320.png" alt="img"></p>
<p><strong>wireshark是捕获机器上的某一块网卡的网络包</strong>，当你的机器上有多块网卡的时候，你需要选择一个网卡。</p>
<p>点击Caputre-&gt;Interfaces.. 出现下面对话框，选择正确的网卡。然后点击”Start”按钮, 开始抓包</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314094604914-1384393003-20200907102059133.png" alt="img"></p>
<p>Wireshark 窗口介绍</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314094626016-1952370119-20200907102110400.png" alt="img"></p>
<p><strong>WireShark 主要分为这几个界面</strong></p>
<p>\1. Display Filter(显示过滤器)， 用于过滤</p>
<p>\2. Packet List Pane(封包列表)， 显示捕获到的封包， 有源地址和目标地址，端口号。 颜色不同，代表</p>
<p>\3. Packet Details Pane(封包详细信息), 显示封包中的字段</p>
<p>\4. Dissector Pane(16进制数据)</p>
<p>\5. Miscellanous(地址栏，杂项)</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314094730951-683976121-20200907102121831.png" alt="img"></p>
<p>使用过滤是非常重要的， 初学者使用wireshark时，将会得到大量的冗余信息，在几千甚至几万条记录中，以至于很难找到自己需要的部分。搞得晕头转向。</p>
<p>过滤器会帮助我们在大量的数据中迅速找到我们需要的信息。</p>
<p>过滤器有两种，</p>
<p>一种是显示过滤器，就是主界面上那个，用来在捕获的记录中找到所需要的记录</p>
<p>一种是捕获过滤器，用来过滤捕获的封包，以免捕获太多的记录。 在Capture -&gt; Capture Filters 中设置</p>
<p>保存过滤</p>
<p>在Filter栏上，填好Filter的表达式后，点击Save按钮， 取个名字。比如”Filter 102”,</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314094843076-11407886-20200907102136609.png" alt="img"></p>
<p>Filter栏上就多了个”Filter 102” 的按钮。</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314094913816-449630993-20200907102143988.png" alt="img"></p>
<p><strong>过滤表达式的规则</strong></p>
<p>表达式规则</p>
<p> \1. 协议过滤</p>
<p>比如TCP，只显示TCP协议。</p>
<p>\2. IP 过滤</p>
<p>比如 ip.src ==192.168.1.102 显示源地址为192.168.1.102，</p>
<p>ip.dst==192.168.1.102, 目标地址为192.168.1.102</p>
<p>\3. 端口过滤</p>
<p>tcp.port ==80, 端口为80的</p>
<p>tcp.srcport == 80, 只显示TCP协议的愿端口为80的。</p>
<p>\4. Http模式过滤</p>
<p>http.request.method==”GET”,  只显示HTTP GET方法的。</p>
<p>\5. 逻辑运算符为 AND/ OR</p>
<p>常用的过滤表达式</p>
<table>
<thead>
<tr>
<th>过滤表达式</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>http</td>
<td>只查看HTTP协议的记录</td>
</tr>
<tr>
<td>ip.src ==192.168.1.102 or ip.dst==192.168.1.102</td>
<td>源地址或者目标地址是192.168.1.102</td>
</tr>
<tr>
<td>snmp &amp;&amp; udp.dstport == 162</td>
<td>抓取SNMP Trap包</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p> 封包列表(Packet List Pane)</p>
<p> 封包列表的面板中显示，编号，时间戳，源地址，目标地址，协议，长度，以及封包信息。 你可以看到不同的协议用了不同的颜色显示。</p>
<p>你也可以修改这些显示颜色的规则， View -&gt;Coloring Rules.</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314095213546-1355213248-20200907102153795.png" alt="img"></p>
<p>封包详细信息 (Packet Details Pane)</p>
<p>这个面板是我们最重要的，用来查看协议中的每一个字段。</p>
<p>各行信息分别为</p>
<p>Frame:  物理层的数据帧概况</p>
<p>Ethernet II: 数据链路层以太网帧头部信息</p>
<p>Internet Protocol Version 4: 互联网层IP包头部信息</p>
<p>Transmission Control Protocol: 传输层T的数据段头部信息，此处是TCP</p>
<p>Hypertext Transfer Protocol: 应用层的信息，此处是HTTP协议</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314095310963-1075553187-20200907102202302.png" alt="img"></p>
<p><strong>TCP包的具体内容</strong></p>
<p> 从下图可以看到wireshark捕获到的TCP包中的每个字段。</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314095338514-530749525-20200907102211935.png" alt="img"></p>
<p>看到这， 基本上对wireshak有了初步了解， 现在我们看一个TCP三次握手的实例</p>
<p> 三次握手过程为</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314095410815-1870221073-20200907102219789.png" alt="img"></p>
<p>这图我都看过很多遍了， 这次我们用wireshark实际分析下三次握手的过程。</p>
<p>打开wireshark, 打开浏览器输入 <a href="http://www.cr173.com" target="_blank" rel="noopener">http://www.cr173.com</a></p>
<p>在wireshark中输入http过滤， 然后选中GET /tankxiao HTTP/1.1的那条记录，右键然后点击”Follow TCP Stream”,</p>
<p>这样做的目的是为了得到与浏览器打开网站相关的数据包，将得到如下图</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/1605493-20190314095516884-1091678120-20200907102228684.png" alt="img"></p>
<p>图中可以看到wireshark截获到了三次握手的三个数据包。第四个包才是HTTP的， 这说明HTTP的确是使用TCP建立连接的。</p>
<p><strong>第一次握手数据包</strong></p>
<p>客户端发送一个TCP，标志位为SYN，序列号为0， 代表客户端请求建立连接。 如下图</p>
<p><strong><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200907104442.png" alt>第二次握手的数据包</strong></p>
<p>服务器发回确认包, 标志位为 SYN,ACK. 将确认序号(Acknowledgement Number)设置为客户的I S N加1以.即0+1=1, 如下图</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200907104507.png" alt></p>
<p><strong>第三次握手的数据包</strong></p>
<p>客户端再次发送确认包(ACK) SYN标志位为0,ACK标志位为1.并且把服务器发来ACK的序号字段+1,放在确定字段中发送给对方.并且在数据段放写ISN的+1, 如下图:</p>
<p><img src="https://gitee.com/songjianzaina/lunanzb_img/raw/master/img/20200907104521.png" alt></p>
<p> 就这样通过了TCP三次握手，建立了连接</p>
<p><strong>本文为作者原创 转载时请注明出处 谢谢</strong></p>
<p><img src="https://gitee.com/songjianzaina/SavePicGoPic/raw/master/img/20191119095516.png" alt></p>
<p><em>乱码三千 – 点滴积累 ,欢迎来到乱码三千技术博客站</em></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="../36/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="../../">1</a><span class="space">&hellip;</span><a class="page-number" href="../36/">36</a><span class="page-number current">37</span><a class="page-number" href="../38/">38</a><span class="space">&hellip;</span><a class="page-number" href="../47/">47</a><a class="extend next" rel="next" href="../38/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">乱码三千</p>
              <p class="site-description motion-element" itemprop="description">android程序员一枚,擅长java,kotlin,python,金融投资,欢迎交流~</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="https://code.newban.cn/archives/">
              
                  <span class="site-state-item-count">469</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">138</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="../../atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">乱码三千</span>
  <div>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  </div>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




  <script type="text/javascript" async src="js/src/mermaid.min.js"></script>
  <script>
  if (window.mermaid) {
        var mermaid_config = {
            startOnLoad: true,
            theme: 'default',
            flowchart:{
                useMaxWidth: false,
                htmlLabels: true
            }                
        }
        mermaid.initialize(mermaid_config);
  }
  </script>
  
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="../../lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="../../lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="../../lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="../../js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="../../js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="../../js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    







  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
